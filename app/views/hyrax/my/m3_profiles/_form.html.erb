<div class="panel-body">
  <% if m3_profile && m3_profile.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(m3_profile.errors.count, "error") %> prohibited this m3_profile from being saved:</h2>

      <ul>
        <% m3_profile.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form.label "Version" %>
  <%= form.text_field :profile_version, :readonly => true, class: "form-control" %><hr>
  <h4>Profile:</h4>
  <%= form.input :name %>
  <%= form.input :profile_type %>
  <%= form.input :responsibility %> 
  <%= form.label :responsiblity_statement %>
  <%= form.select(:responsibility_statement, ["Indiana University"], {}, { class: "form-control" }) %>
  <%= form.input :date_modified, :readonly => true, required: false %><hr>
  
  <!-- nested_form_for -->
  <h4>Classes:</h4>
  <%= form.nested_fields_for :classes , wrapper_tag: :div do |c| %>
    <h4>Class:</h4>
    <%= c.label :name %>
    <%= c.select(:name, @m3_profile.available_classes, { include_blank: true }, { class: "form-control" }) %></br>
    <%= c.input :display_label %>

    <%= c.remove_nested_fields_link 'Remove Class', class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %><hr>
  <% end %>
  <%= form.add_nested_fields_link :classes, 'Add Class', class: 'btn btn-success' %>
  <br /><br />

  <h4>Contexts:</h4>
  <%= form.nested_fields_for :contexts do |cc| %>
    <h4>Context:</h4>
    <%= cc.input :name %>
    <%= cc.input :display_label %><hr>
    <%= cc.remove_nested_fields_link 'Remove Context', class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %><hr>
  <% end %>
  <%= form.add_nested_fields_link :contexts, 'Add Context', class: 'btn btn-success' %>
  <br /><br />

  <h4>Properties:</h4>
  <%= form.nested_fields_for :properties do |p| %>
    <h4>Property</h4>
    <%= p.input :name %>
    <%= p.input :property_uri %>
    <%= p.input :cardinality_minimum %>
    <%= p.input :cardinality_maximum %>
    <%= p.label :indexing %>
    <%= p.select(:indexing, M3::ProfileProperty::INDEXING, { include_hidden: false }, { multiple: true, class: "form-control" }) %><hr>
    <h4>Texts:</h4>
    <%= p.nested_fields_for :texts do |t| %>
      <h4>Text:</h4>
      <%= t.label :name %>
      <%= t.select(:name, @m3_profile.available_text_names, { include_blank: true }, { class: "form-control" }) %>
      <%= t.input :value %>
      <%= t.remove_nested_fields_link 'Remove Text', class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %>
    <% end %>
      <%= p.add_nested_fields_link :texts, 'Add Text', class: 'btn btn-success' %>
      <br /><br />
    <%= p.remove_nested_fields_link 'Remove Property', class: 'btn btn-danger', data: { confirm: 'Are you sure?' } %>
    <hr>
  <% end %>
  <%= form.add_nested_fields_link :properties, 'Add Property', class: 'btn btn-success' %>
</div>
